lines(data[2,,4])
lines(data[3,,4])
data[,,1] <- t(apply(data[,,1], 1, scale))
out_2 <- detect_cp_multivariate(data = data[,,1], n_iterations = 5000, q = 0.5, k_0 = 0.25, nu_0 = 4, phi_0 = diag(1,3,3), m_0 = rep(0,3))
library(BayesCPs)
library(dplyr)
library(ggplot2)
library(BayesCPs)
library(BNPmix)
First_Day <- "2020-01-01"
Last_Day <- "2022-01-01"
data <- array(NA, c(3,505,50))
companies <- c("MSFT","AAPL","AMZN","NVDA","GOOGL","GOOG","BRK-B","UNH","LLY",
"JPM","XOM","AVGO","V","JNJ","PG","MA","HD","ADBE","COST","CVX","MRK","PEP","KO",
"WMT","CRM","NFLX","ACN","MCD","BAC","LIN","AMD","CSCO","TMO","INTC","ORCL","ABT",
"CMCSA","DIS","PFE","WFC","INTU","VZ","PM","DHR","AMGN","IBM","QCOM","TXN","COP","UNP")
for(i in 1:50){
DATA <- read.csv(paste0("G:/My Drive/Dottorato/Progetti/Model Based Clustering of TS/Backup project/Model-Based-Clustering-of-Time-Series/stock_data/",companies[i],".csv"), header = TRUE)
DATA <- DATA %>%
mutate(Mean = (High + Low)/2) %>%
mutate(Date = as.Date(Date)) %>%
dplyr::select(Date, Open, Mean, Close)
DATA <- DATA[which(DATA$Date >= First_Day & DATA$Date < Last_Day),]
data[,,i] <- t(DATA[,c(2,3,4)])
#ggplot(DATA) +
#  geom_line(aes(x = Date, y = Open)) +
#  geom_line(aes(x = Date, y = Mean), col = "darkblue") +
#  geom_line(aes(x = Date, y = Close), col = "darkred")
#data[[i]] <- DATA[,c(2,3,4)]
}
plot(data[1,,4], type = "l")
lines(data[2,,4])
lines(data[3,,4])
data[,,1] <- t(apply(data[,,1], 1, scale))
out_2 <- detect_cp_multivariate(data = data[,,1], n_iterations = 5000, q = 0.5, k_0 = 0.25, nu_0 = 4, phi_0 = diag(1,3,3), m_0 = rep(0,3))
devtools::load_all(".")
library(dplyr)
library(ggplot2)
library(BayesCPs)
library(BNPmix)
First_Day <- "2020-01-01"
Last_Day <- "2022-01-01"
data <- array(NA, c(3,505,50))
companies <- c("MSFT","AAPL","AMZN","NVDA","GOOGL","GOOG","BRK-B","UNH","LLY",
"JPM","XOM","AVGO","V","JNJ","PG","MA","HD","ADBE","COST","CVX","MRK","PEP","KO",
"WMT","CRM","NFLX","ACN","MCD","BAC","LIN","AMD","CSCO","TMO","INTC","ORCL","ABT",
"CMCSA","DIS","PFE","WFC","INTU","VZ","PM","DHR","AMGN","IBM","QCOM","TXN","COP","UNP")
for(i in 1:50){
DATA <- read.csv(paste0("G:/My Drive/Dottorato/Progetti/Model Based Clustering of TS/Backup project/Model-Based-Clustering-of-Time-Series/stock_data/",companies[i],".csv"), header = TRUE)
DATA <- DATA %>%
mutate(Mean = (High + Low)/2) %>%
mutate(Date = as.Date(Date)) %>%
dplyr::select(Date, Open, Mean, Close)
DATA <- DATA[which(DATA$Date >= First_Day & DATA$Date < Last_Day),]
data[,,i] <- t(DATA[,c(2,3,4)])
#ggplot(DATA) +
#  geom_line(aes(x = Date, y = Open)) +
#  geom_line(aes(x = Date, y = Mean), col = "darkblue") +
#  geom_line(aes(x = Date, y = Close), col = "darkred")
#data[[i]] <- DATA[,c(2,3,4)]
}
plot(data[1,,4], type = "l")
lines(data[2,,4])
lines(data[3,,4])
data[,,1] <- t(apply(data[,,1], 1, scale))
out_2 <- detect_cp_multivariate(data = data[,,1], n_iterations = 5000, q = 0.5, k_0 = 0.25, nu_0 = 4, phi_0 = diag(1,3,3), m_0 = rep(0,3))
cps <- table(get_order_VI(out_2$orders[2000:3000,]))
abline(v = cumsum(cps)[-length(cps)])
for(i in 1:50){
data[,,i] <- t(apply(data[,,i], 1, scale))
}
out <- cluster_cp_multi(data = data,
n_iterations = 50000, B = 100000, L = 1, gamma = 0.1, q = 0.25, alpha_SM = 0.01, k_0 = 0.25,
nu_0 = 4, phi_0 = diag(1,3,3), m_0 = rep(0,3))
usethis::use_test(test-get_clust_VI)
usethis::use_test("test-get_clust_VI")
get_clust_VI
devtools::load_all(".")
clust <- matrix(c(0,0,0,1,1,
0,0,0,1,1,
0,0,0,1,1), 3,4)
clust <- matrix(c(0,0,0,1,1,
0,0,0,1,1,
0,0,0,1,1), 3,6)
clust <- matrix(c(0,0,0,1,1,
0,0,0,1,1,
0,0,0,1,1), 3,5)
out_clust <- get_clust_VI(clust)
out_clust
clust
clust <- matrix(c(0,0,0,0,0,
0,0,0,0,1,
1,1,1,1,1), 3,5)
out_clust <- get_clust_VI(clust)
out_clust
t(out_clust)
expect_equal(t(out_clust), c(0,0,0,1,1))
expect_equal(table(out_clust), table(c(0,0,0,1,1)))
expect_equal(table(out_clust), table(c(0,0,0,1,1)))
out_clust <- as.numeric(get_clust_VI(clust))
out_clust
expect_equal(out_clust, c(0,0,0,1,1))
devtools::load_all(".")
?psm
?psm
?psm
mcclust.ext::minbinder.ext()
mcclust.ext::minbinder.ext
usethis::use_test("test-psm")
clust <- matrix(c(0,0,0,0,0,
0,0,0,0,1,
1,1,1,1,1), 3,5)
psm(clust)
matrix(c(1,1,1,0,0,
1,1,1,0,0,
1,1,1,0,0,
0,0,0,1,1,
0,0,0,1,1), 5,5)
data_mat <- matrix(NA, nrow = 5, ncol = 100)
data_mat[1,] <- as.numeric(c(rnorm(50,0,0.100), rnorm(50,1,0.250)))
data_mat[2,] <- as.numeric(c(rnorm(50,0,0.125), rnorm(50,1,0.225)))
data_mat[3,] <- as.numeric(c(rnorm(50,0,0.175), rnorm(50,1,0.280)))
data_mat[4,] <- as.numeric(c(rnorm(25,0,0.135), rnorm(75,1,0.225)))
data_mat[5,] <- as.numeric(c(rnorm(25,0,0.155), rnorm(75,1,0.280)))
length_orders <- as.numeric()
for(i in 1:5){
out_test <- cluster_cp_uni(data = data_mat,
n_iterations = 5000,
B = 1000, L = 1, gamma = 0.5, print_progress = FALSE)
length_orders[i] <- length(table(get_clust_VI(out_test$clust[1000:5000,])))
}
length_orders
mean(length_orders)
mean(length_orders) < 4.1 & mean(length_orders) > 0.9
median(length_orders)
cluster_cp_uni(data = data_mat,
n_iterations = 5000,
B = 1000, L = 1, gamma = 0.1, print_progress = FALSE)
get_clust_VI(out_test$clust[1000:5000,])
usethis::use_readme_md()
library(BayesCPs)
devtools::load_all(".")
library(dplyr)
library(ggplot2)
library(BayesCPs)
library(BNPmix)
First_Day <- "2020-01-01"
Last_Day <- "2022-01-01"
data <- array(NA, c(3,505,50))
companies <- c("MSFT","AAPL","AMZN","NVDA","GOOGL","GOOG","BRK-B","UNH","LLY",
"JPM","XOM","AVGO","V","JNJ","PG","MA","HD","ADBE","COST","CVX","MRK","PEP","KO",
"WMT","CRM","NFLX","ACN","MCD","BAC","LIN","AMD","CSCO","TMO","INTC","ORCL","ABT",
"CMCSA","DIS","PFE","WFC","INTU","VZ","PM","DHR","AMGN","IBM","QCOM","TXN","COP","UNP")
for(i in 1:50){
DATA <- read.csv(paste0("H:/Il Mio Drive/Dottorato/Progetti/Model Based Clustering of TS/Backup project/Model-Based-Clustering-of-Time-Series/stock_data/",companies[i],".csv"), header = TRUE)
DATA <- DATA %>%
mutate(Mean = (High + Low)/2) %>%
mutate(Date = as.Date(Date)) %>%
dplyr::select(Date, Open, Mean, Close)
DATA <- DATA[which(DATA$Date >= First_Day & DATA$Date < Last_Day),]
DATA[,2] <- scale(DATA[,2])
DATA[,3] <- scale(DATA[,3])
DATA[,4] <- scale(DATA[,4])
data[,,i] <- t(DATA[,c(2,3,4)])
#ggplot(DATA) +
#  geom_line(aes(x = Date, y = Open)) +
#  geom_line(aes(x = Date, y = Mean), col = "darkblue") +
#  geom_line(aes(x = Date, y = Close), col = "darkred")
#data[[i]] <- DATA[,c(2,3,4)]
}
for(i in 1:50){
DATA <- read.csv(paste0("G:/My Drive/Dottorato/Progetti/Model Based Clustering of TS/Backup project/Model-Based-Clustering-of-Time-Series/stock_data/",companies[i],".csv"), header = TRUE)
DATA <- DATA %>%
mutate(Mean = (High + Low)/2) %>%
mutate(Date = as.Date(Date)) %>%
dplyr::select(Date, Open, Mean, Close)
DATA <- DATA[which(DATA$Date >= First_Day & DATA$Date < Last_Day),]
DATA[,2] <- scale(DATA[,2])
DATA[,3] <- scale(DATA[,3])
DATA[,4] <- scale(DATA[,4])
data[,,i] <- t(DATA[,c(2,3,4)])
#ggplot(DATA) +
#  geom_line(aes(x = Date, y = Open)) +
#  geom_line(aes(x = Date, y = Mean), col = "darkblue") +
#  geom_line(aes(x = Date, y = Close), col = "darkred")
#data[[i]] <- DATA[,c(2,3,4)]
}
data
out <- cluster_cp_multi(data = data,
n_iterations = 13000, B = 100000, L = 50, gamma = 0.75,
q = 0.1, alpha_SM = 1, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(1,3,3), m_0 = rep(0,3), coars = 0.25)
data_uni <- matrix(NA,nrow = 50, ncol = 505)
for(i in 1:50){
data_uni[i,] <- data[2,,i]
}
plot(data_uni[8,], type = "l")
out <- cluster_cp_uni(data = data_uni, n_iterations = 15000, B = 10000, L = 1,
gamma = 0.75, alpha_SM = 1, q = 0.1,coars = 0.25 )
MCMC_chain <- out$clust[2500:15000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#046A38"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),
#labels =c(TeX("$\\y_{1}$"),TeX("$\\y_{2}$"),TeX("$\\y_{3}$"),TeX("$\\y_{4}$"),TeX("$\\y_{5}$"),TeX("$\\y_{6}$"),TeX("$\\y_{7}$"))) +
labels =c(seq(1,50))) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),
#labels = c(TeX("$\\y_{1}$"),TeX("$\\y_{2}$"),TeX("$\\y_{3}$"),TeX("$\\y_{4}$"),TeX("$\\y_{5}$"),TeX("$\\y_{6}$"),TeX("$\\y_{7}$"))) +
labels =c(seq(1,50))) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
MCMC_chain <- out$clust[1000:5000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#046A38"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),
#labels =c(TeX("$\\y_{1}$"),TeX("$\\y_{2}$"),TeX("$\\y_{3}$"),TeX("$\\y_{4}$"),TeX("$\\y_{5}$"),TeX("$\\y_{6}$"),TeX("$\\y_{7}$"))) +
labels =c(seq(1,50))) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),
#labels = c(TeX("$\\y_{1}$"),TeX("$\\y_{2}$"),TeX("$\\y_{3}$"),TeX("$\\y_{4}$"),TeX("$\\y_{5}$"),TeX("$\\y_{6}$"),TeX("$\\y_{7}$"))) +
labels =c(seq(1,50))) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
plot(data[1,,4], type = "l")
lines(data[2,,4])
lines(data[3,,4])
out_2 <- detect_cp_multivariate(data = data[,,4], n_iterations = 5000,
q = 0.5, k_0 = 0.05,
nu_0 = 10, phi_0 = diag(0.01,3,3),
m_0 = rep(0,3))
abline(v = cumsum(cps)[-length(cps)])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
cps
out_2 <- detect_cp_multivariate(data = data[,,4], n_iterations = 5000,
q = 0.1, k_0 = 0.5,
nu_0 = 10, phi_0 = diag(0.01,3,3),
m_0 = rep(0,3))
plot(data[1,,4], type = "l")
lines(data[2,,4])
lines(data[3,,4])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,1], n_iterations = 5000,
q = 0.1, k_0 = 0.5,
nu_0 = 10, phi_0 = diag(0.01,3,3),
m_0 = rep(0,3))
plot(data[1,,1], type = "l")
lines(data[2,,1])
lines(data[3,,1])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.1, k_0 = 0.5,
nu_0 = 10, phi_0 = diag(0.01,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.1, k_0 = 0.5,
nu_0 = 10, phi_0 = diag(1,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.1, k_0 = 0.25,
nu_0 = 10, phi_0 = diag(1,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.5, k_0 = 0.25,
nu_0 = 10, phi_0 = diag(1,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.5, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(1,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
out_2 <- detect_cp_multivariate(data = data[,,20], n_iterations = 5000,
q = 0.5, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(0.01,3,3),
m_0 = rep(0,3))
plot(data[1,,20], type = "l")
lines(data[2,,20])
lines(data[3,,20])
cps <- table(mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(out_2$orders[2000:5000,])),
cls.draw = clean_partition(out_2$orders[2000:5000,]))$cl)
abline(v = cumsum(cps)[-length(cps)])
log_sum_exp(c(100,200))
devtools::load_all(".")
out <- cluster_cp_multi(data = data,
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.1, alpha_SM = 1, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(1,3,3), m_0 = rep(0,3), coars = 0.25)
MCMC_chain <- out$clust[3000:13000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#046A38"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1), labels = seq) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),labels = seq) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
out$clust
out$clust[3000:13000,]
psm_matrix
out$orders
out$orders[,,13000]
est_clust
detect_cp_multivariate
out <- cluster_cp_multi(data = data[1:10,],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.5, alpha_SM = 10, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(1,3,3), m_0 = rep(0,3), coars = 0.25)
data
out <- cluster_cp_multi(data = data[,,1:10],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.5, alpha_SM = 10, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(1,3,3), m_0 = rep(0,3), coars = 0.25)
MCMC_chain <- out$clust[3000:13000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#046A38"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1), labels = seq) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),labels = seq) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
data_uni <- matrix(NA,nrow = 50, ncol = 505)
out <- cluster_cp_multi(data = data[,,1:10],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.5, alpha_SM = 10, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(0.01,3,3), m_0 = rep(0,3), coars = 0.25)
MCMC_chain <- out$clust[3000:13000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#F8766D"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1), labels = seq) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),labels = seq) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
out <- cluster_cp_multi(data = data[,,1:30],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.5, alpha_SM = 10, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(0.01,3,3), m_0 = rep(0,3), coars = 0.25)
out <- cluster_cp_multi(data = data[,,1:10],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.5, alpha_SM = 1, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(0.01,3,3), m_0 = rep(0,3), coars = 0.25)
MCMC_chain <- out$clust[3000:13000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#F8766D"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1), labels = seq) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),labels = seq) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
out <- cluster_cp_multi(data = data[,,1:10],
n_iterations = 13000, B = 10000, L = 50, gamma = 0.75,
q = 0.1, alpha_SM = 1, k_0 = 0.25,
nu_0 = 5, phi_0 = diag(0.01,3,3), m_0 = rep(0,3), coars = 0.25)
MCMC_chain <- out$clust[3000:13000,]
est_clust <- mcclust.ext::minbinder.ext(psm = salso::psm(clean_partition(MCMC_chain)), cls.draw = clean_partition(MCMC_chain))$cl
est_clust
seq <- as.numeric()
for(i in 1:length(table(est_clust))){
seq <- c(seq,which(est_clust == as.numeric(names(sort(table(est_clust), decreasing = TRUE))[i])))
}
psm_matrix <- salso::psm(clean_partition(MCMC_chain))[seq,seq]
matrix_out <- reshape2::melt(psm_matrix[1:nrow(psm_matrix), , drop = FALSE])
plot_heat <- ggplot(matrix_out) +
geom_tile(aes(x = Var2, y = Var1, fill = value), na.rm = TRUE, size = 0.0,show.legend = FALSE) +
scale_fill_gradient(
low = "transparent",
high = "#F8766D"
) +
labs(x = "", y = "", fill = "") +
theme_linedraw() +
coord_cartesian(xlim = c(0, ncol(psm_matrix) + 1), ylim = c(0, ncol(psm_matrix) + 1), expand = FALSE) +
scale_x_continuous(breaks = seq(1, ncol(psm_matrix), by = 1), labels = seq) +
scale_y_continuous(breaks = seq(1, ncol(psm_matrix), by = 1),labels = seq) +
theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
axis.text.y = element_text(size = 8),
panel.grid.major = element_blank(),
panel.grid.minor = element_line(size=0.1))
plot_heat
